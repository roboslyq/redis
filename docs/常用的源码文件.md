# 常用的源码文件

# 主程序(服务端与客户端)

- redis.c 
   - redis服务端启动程序

- redis_cli.c
  - redis客户端程序启动程序

# 内存管理

> 关于Redis的内存分配的封装实现

- zmalloc.c
- sdsalloc.h
- rax_malloc.h
- listpack_malloc.h

# 数据结构

- sds.c
  - 用于对字符串的定义，最基础的数据结构
- dict.c 
  - 主要对于内存中的hash进行管理
- adlist.c 
  - 用于对list的定义，它是个双向链表结构 
- ziplist.c 
  - ziplist是一个类似于list的存储对象。它的原理类似于zipmap。
- quicklist.c
  - 新加了list结构，以ziplist为基础
- sparkline.c
  -  一个拥有sample列表的序列

- zipmap.c  
  - zipmap是一个类似于hash的存储对象。

- intset.c
  - 整数集合

# 指令操作

- t_hash.c
  - Hash相关的操作,主要是Server/Client中的应答操作。主要通过redisObject进行类型转换。
- t_list.c
  - List相关操作,主要是Server/Client中的应答操作。主要通过redisObject进行类型转换。
- t_set.c
  - Set相关操作,主要是Server/Client中的应答操作。主要通过redisObject进行类型转换。
- t_stream.c
  - Stream相关操作(5.x之后),主要是Server/Client中的应答操作。主要通过redisObject进行类型转换。
- t_string.c
  - String相关操作,主要是Server/Client中的应答操作。主要通过redisObject进行类型转换。
- t_zset.c
  - zset相关操作,主要是Server/Client中的应答操作。主要通过redisObject进行类型转换。

# AE事件库

- ae.c
  - redis I/O模型
- ae_epoll.c
  - epoll I/O模型实现
- ae_evport.c
  - evport I/O模型实现
- ae_kqueue.c
  - kqueue I/O模型实现
- ae_select.c
  - select I/O模型实现

# 网络连接

- anet.c
  -  作为Server/Client通信的基础封装

- networking.c 
  - 网络协议传输方法定义相关的都放在这个文件里面了。

- connection.c
  - TOTO
- connhelpers.h

# 哨兵

- sentinel.c
  - 哨兵模式实现高可用

# Cluster集群

- cluster.c
  - 3.0之后，集群模式实现

# 数据库

- db.c
  - 数据库实现
- config.c 
  - 用于将配置文件redis.conf文件中的配置读取出来的属性通过程序放到server对象中。

- multi.c
  - 用于事务处理操作。
- replication.c 
  - 用于主从数据库的复制操作的实现。从而实现redis读写分离

# 持久化备份 

- aof.c
  - 全称为append only file，作用就是记录每次的写操作,在遇到断电等问题时可以用它来恢复数据库状态。

- rdb.c
  - 对于Redis本地数据库的相关操作，默认文件是dump.rdb（通过配置文件获得），包括的操作包括保存，移除，查询等等。

# 地理位置

>  GeoHash将二维的经纬度转换成字符串 。 Redis3.2版本提供，支持存储地理位置信息用来实现诸如附近位置、摇一摇这类依赖于地理位置信息的功能.geo的数据类型为zset 。

- geo.c
- geohash.c
- geohash_helper.c
- gopher.c

# 工具类

- bitops.c 
  - 位操作相关类
- debug.c 
  - 用于调试时使用
- debugmacro.h
- endianconv.c 
  - 高低位转换，不同系统，高低位顺序不同
- help.h  
  - 辅助于命令的提示信息
- 5.lzf_c.c
  -  压缩算法系列
- 6.lzf_d.c
  -   压缩算法系列
- rand.c
  -  用于产生随机数
- release.c
  -  用于发步时使用
- sha1.c 
  - sha加密算法的实现
- util.c 
  -  通用工具方法
- crc64.c 
  - 循环冗余校验
- lzf.h
- lzf_c.c
- lzf_d.c
- lzfP.h
- sha1.c
- sha1.h
- sha256.c
- sha256.h
- util.c
- util.h
- crc16.c
- crc16_slottable.h
- crc64.c
- crc64.h

# Redis基数树

>  Redis实现了不定长压缩前缀的radix tree，用在集群模式下存储slot对应的的所有key信息。本文将详述在Redis中如何实现radix tree 

- rax.c

# Stream相关

> Redis5之后 

- stream.h

- lolwut.c
- lolwut5.c
- lolwut6.c
- listpack.c

# 封装类(Wrapper)

- bio.c 
  - background I/O的意思，开启后台线程用的
- hyperloglog.c 
  - 一种日志类型的
- latency.c 
  - 延迟类
- 5.migrate.c 
  - 命令迁移类，包括命令的还原迁移等
- notify.c 
  - 通知类
- object.c 
  -  用于创建和释放redisObject对象
- pqsort.c  
  - 排序算法类
-  pubsub.c 
  - 用于订阅模式的实现，有点类似于Client广播发送的方式。
- rio.c redis
  - 定义的一个I/O类
- slowlog.c 
  - 一种日志类型的，与hyperloglog.c类似
- sort.c 
  - 排序算法类，与pqsort.c使用的场景不同
- syncio.c 
  - 用于同步Socket和文件I/O操作。
- tls.c
  -  安全传输协议实现 

# Module(模块化)

- module.c
- redismodule.h

> Redis自4.0版本之后便支持了模块扩展功能, Redis推荐开发人员通过引入redismodule.h, 来调用指定接口来支持扩展, 其中要求实现程序必须实现RedisModule_OnLoad方法, 该方法主要加载模块, 注册相应的api, 对context上下文注入

使用方式 ：

1、用户扩展模块需要通过配置文件指定需要加载的链接库(redis.conf配置文件)

> ```properties
> # loadmodule /path/to/my_module.so
> # loadmodule /path/to/other_module.so
> ```

2、生成so文件

> 动态库需要用户自己去编译生成, 在编译之前需要将指定的module引入redismodule.h头文件, 最简单的方式是直接将源文件拉入modules下, 修改MakeFile文件并执行make编译

# 测试

- memtest.c 
  - 内存检测

- redis_benchmark.c 
  - 用于redis性能测试的实现。
- redis_check_aof.c 
  - 用于更新日志检查的实现。
- redis_check_dump.c 
  - 用于本地数据库检查的实现。
- testhelp.c 
  - 一个C风格的小型测试框架。

# 其它

## 基本信息

- version.h
  - 定义Redis的版本号
- asciilogo.c
  -  redis启动时logo显示

## 兼容

- fmacros.h 
  - 兼容Mac系统下的问题
- solarisfixes.h 
  - 兼容solary下的问题

## ACL权限控制

>  Access Control List（访问控制列表）的缩写 

- acl.c

## 脚本相关

- scripting.c

## 未分类

- atomicvar.h
- blocked.c
- childinfo.c
- defrag.c
- evict.c
- expire.c
- lazyfree.c
- localtime.c
- mkreleasehdr.sh
- redis-trib.rb
- redisassert.h
- setproctitle.c
- siphash.c
- timeout.c
- tracking.c
- valgrind.sup